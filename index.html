<!DOCTYPE html>
<html>
    <head>
        <title>MashUp Test</title>
    </head>
    <body>
        <div>
            <h2>ID:</h2>
            <h3 id="bp_id"></h3>
        </div>
        <div>
            <h2>Email:</h2>
            <h3 id="data_name"></h3>
        </div>

        <script>
            const pa = new URLSearchParams(window.location.search);
            const userKey = pa.get("userKey");
            const secret = pa.get("secret");
            const apiKey = pa.get("apiKey");
            let bp_id = pa.get("bp_id");
            
            document.getElementById("bp_id").innerHTML = bp_id;
            
            let url = `https://accounts.eu2.gigya.com/accounts.getAccountInfo?ApiKey=${apiKey}&userKey=${userKey}&secret=${secret}&UID=${bp_id}`
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`Response status: ${response.status}`);
            }
            const json = await response.json();
            console.log(json);

            document.getElementById("bp_id").innerHTML = json.profile.email;
            debugger;
            debugger;
        </script>
    </body>
</html>